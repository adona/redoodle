!function(t){function e(e){for(var a,l,o=e[0],s=e[1],p=e[2],u=0,d=[];u<o.length;u++)l=o[u],i[l]&&d.push(i[l][0]),i[l]=0;for(a in s)Object.prototype.hasOwnProperty.call(s,a)&&(t[a]=s[a]);for(c&&c(e);d.length;)d.shift()();return r.push.apply(r,p||[]),n()}function n(){for(var t,e=0;e<r.length;e++){for(var n=r[e],a=!0,o=1;o<n.length;o++){var s=n[o];0!==i[s]&&(a=!1)}a&&(r.splice(e--,1),t=l(l.s=n[0]))}return t}var a={},i={8:0,3:0,5:0},r=[];function l(e){if(a[e])return a[e].exports;var n=a[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,l),n.l=!0,n.exports}l.m=t,l.c=a,l.d=function(t,e,n){l.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},l.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},l.t=function(t,e){if(1&e&&(t=l(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(l.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)l.d(n,a,function(e){return t[e]}.bind(null,a));return n},l.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return l.d(e,"a",e),e},l.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},l.p="";var o=window.webpackJsonp=window.webpackJsonp||[],s=o.push.bind(o);o.push=e,o=o.slice();for(var p=0;p<o.length;p++)e(o[p]);var c=s;r.push([179,0]),n()}({10:function(t,e,n){"use strict";n.r(e),n.d(e,"PAGES",function(){return b}),n.d(e,"MainHeader",function(){return E}),n.d(e,"UserMenu",function(){return g}),n.d(e,"CreatePollButton",function(){return S});var a=n(2),i=n.n(a),r=n(0),l=n.n(r);n(13);function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function p(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}function c(t,e,n){return e&&p(t.prototype,e),n&&p(t,n),t}function u(t,e){return!e||"object"!==o(e)&&"function"!=typeof e?d(t):e}function d(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function h(t){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function m(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&f(t,e)}function f(t,e){return(f=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var y=i()("body").attr("user");"Anonymous"!=y&&(y=JSON.parse(y));var b={dashboard:{description:"Dashboard"},logout:{description:"Log out"},create_poll:{description:"Create"}};for(var v in b)b[v].url=i()("body").attr("url_".concat(v));var E=function(t){function e(){return s(this,e),u(this,h(e).apply(this,arguments))}return m(e,l.a.Component),c(e,[{key:"render",value:function(){return l.a.createElement("div",{id:"main-header"},l.a.createElement("div",{id:"header-nav"},l.a.createElement("div",{id:"header-nav-left"},l.a.createElement("a",{id:"logo",href:b.dashboard.url},"ReDoodle")),l.a.createElement("div",{id:"header-nav-right"},l.a.createElement(g,{entries:this.props.entries}),this.props.showCreatePollButton?l.a.createElement(S,null):"")))}}]),e}(),g=function(t){function e(t){var n,a,r,l;return s(this,e),n=u(this,h(e).call(this,t)),a=d(n),l=function(){return i()("#user-menu-entries").toggleClass("expanded")},(r="toggleExpand")in a?Object.defineProperty(a,r,{value:l,enumerable:!0,configurable:!0,writable:!0}):a[r]=l,window.onclick=function(t){t.target.matches("#user-menu-button")||i()("#user-menu-entries").removeClass("expanded")},n}return m(e,l.a.Component),c(e,[{key:"render",value:function(){return l.a.createElement("div",{id:"user-menu"},l.a.createElement("button",{id:"user-menu-button",onClick:this.toggleExpand},"".concat(y.first_name," ").concat(y.last_name),l.a.createElement("span",{id:"down-arrow"},"⌄")),l.a.createElement("ul",{id:"user-menu-entries"},this.props.entries.map(function(t,e){return l.a.createElement("li",{key:e,className:"user-menu-entry"},l.a.createElement("a",{href:b[t].url},b[t].description))})))}}]),e}(),S=function(t){function e(){return s(this,e),u(this,h(e).apply(this,arguments))}return m(e,l.a.Component),c(e,[{key:"render",value:function(){return l.a.createElement("a",{id:"create-poll-button",href:b.create_poll.url},"+ ",b.create_poll.description)}}]),e}()},13:function(t,e,n){},179:function(t,e,n){"use strict";n.r(e);var a=n(2),i=n.n(a),r=n(0),l=n.n(r),o=n(11),s=n.n(o),p=n(10);n(9),n(180);function c(t){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function u(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function d(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}function h(t,e,n){return e&&d(t.prototype,e),n&&d(t,n),t}function m(t,e){return!e||"object"!==c(e)&&"function"!=typeof e?f(t):e}function f(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function y(t){return(y=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function b(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&v(t,e)}function v(t,e){return(v=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var E=["January","February","March","April","May","June","July","August","September","October","November","December"],g=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],S=JSON.parse(i()("body").attr("poll"));console.log(S);var P=function(t){function e(){return u(this,e),m(this,y(e).apply(this,arguments))}return b(e,l.a.Component),h(e,[{key:"render",value:function(){var t=this.props.poll;return l.a.createElement("div",{id:"poll-container"},l.a.createElement(k,{name:t.name,author:t.author}),l.a.createElement(C,{poll:t}))}}]),e}(),k=function(t){function e(){return u(this,e),m(this,y(e).apply(this,arguments))}return b(e,l.a.Component),h(e,[{key:"render",value:function(){var t=this.props.author;return l.a.createElement("div",{id:"poll-header"},l.a.createElement("h1",null,this.props.name),l.a.createElement("p",null,t.first_name," ",t.last_name," • 1h hours ago • Print"))}}]),e}(),C=function(t){function e(){return u(this,e),m(this,y(e).apply(this,arguments))}return b(e,l.a.Component),h(e,[{key:"render",value:function(){var t=this.props.poll;return l.a.createElement("div",{id:"poll-main"},l.a.createElement(N,{location:t.location,notes:t.notes,timezone:t.timezone}),l.a.createElement(w,{pollid:t.id,polltimes:t.polltimes,participants:t.participants}))}}]),e}(),N=function(t){function e(){return u(this,e),m(this,y(e).apply(this,arguments))}return b(e,l.a.Component),h(e,[{key:"render",value:function(){return l.a.createElement("div",{id:"poll-details"},l.a.createElement("p",null," ",l.a.createElement("i",{className:"fas fa-map-marker-alt"})," ",this.props.location," "),l.a.createElement("p",null," ",l.a.createElement("i",{className:"fas fa-align-left"})," ",this.props.notes," "),l.a.createElement("p",null," ",l.a.createElement("i",{className:"far fa-clock"})," All times displayed in ",l.a.createElement("b",null,this.props.timezone)," "))}}]),e}(),w=function(t){function e(t){var n;return u(this,e),(n=m(this,y(e).call(this,t))).state={participants:n.props.participants,idxEditing:null,isNewParticipant:null},n.handleAddParticipant=n.handleAddParticipant.bind(f(n)),n.handleStartEditing=n.handleStartEditing.bind(f(n)),n.handleNameChange=n.handleNameChange.bind(f(n)),n.handleAvailabilityChange=n.handleAvailabilityChange.bind(f(n)),n.handleDeleteParticipant=n.handleDeleteParticipant.bind(f(n)),n.handleStopEditing=n.handleStopEditing.bind(f(n)),n}return b(e,l.a.Component),h(e,[{key:"handleAddParticipant",value:function(){var t=this.state.participants,e={poll:this.props.pollid,name:"",availability:this.props.polltimes.map(function(t){return{polltime:t.id,availability:"N"}})};t.unshift(e),this.setState({participants:t,idxEditing:0,isNewParticipant:!0})}},{key:"handleStartEditing",value:function(t){this.setState({idxEditing:t,isNewParticipant:!1})}},{key:"handleNameChange",value:function(t,e){var n=this.state.participants;n[t].name=e,this.setState({participants:n})}},{key:"handleAvailabilityChange",value:function(t,e,n){var a=this.state.participants;a[t].availability[e].availability=n,this.setState({participants:a})}},{key:"handleStopEditing",value:function(){var t=this,e=this.state.participants,n=e[this.state.idxEditing],a=this.state.isNewParticipant?"POST":"PUT";i.a.ajax({url:"",type:a,contentType:"application/json",data:JSON.stringify(n)}).done(function(n){t.state.isNewParticipant&&(e[t.state.idxEditing]=n),t.setState({participants:e,idxEditing:null,isNewParticipant:null}),console.log("Participant updated.")}).fail(function(t){console.log("Failed to update participant."),console.log(t.responseText)})}},{key:"handleDeleteParticipant",value:function(t){var e=this,n=this.state.participants,a=n[t],r=function(){n.splice(t,1),e.setState({participants:n,idxEditing:null,isNewParticipant:null}),console.log("Participant deleted.")};this.state.isNewParticipant?r():i.a.ajax({url:"",type:"DELETE",contentType:"application/json",data:JSON.stringify({id:a.id})}).done(r).fail(function(){console.log("Failed to delete participant.")})}},{key:"render",value:function(){return l.a.createElement("div",{id:"poll-participants-container"},l.a.createElement(x,{polltimes:this.props.polltimes,participants:this.state.participants,onAddParticipant:this.handleAddParticipant,onStartEditing:this.handleStartEditing,idxEditing:this.state.idxEditing,onNameChange:this.handleNameChange,onAvailabilityChange:this.handleAvailabilityChange,onDeleteParticipant:this.handleDeleteParticipant}),null==this.state.idxEditing?"":l.a.createElement(D,{idxEditing:this.state.idxEditing,isNewParticipant:this.state.isNewParticipant,participant:this.state.participants[this.state.idxEditing],onStopEditing:this.handleStopEditing}))}}]),e}(),x=function(t){function e(){return u(this,e),m(this,y(e).apply(this,arguments))}return b(e,l.a.Component),h(e,[{key:"render",value:function(){var t=this,e=null!=this.props.idxEditing;return l.a.createElement("table",{id:"poll-participants-table"},l.a.createElement(O,{polltimes:this.props.polltimes}),l.a.createElement("tbody",null,l.a.createElement(_,{polltimes:this.props.polltimes,participants:this.props.participants,isEditable:!e,onAddParticipant:this.props.onAddParticipant}),this.props.participants.map(function(n,a){return t.props.idxEditing!=a?l.a.createElement(j,{key:a,idx:a,participant:n,isEditable:!e,onStartEditing:t.props.onStartEditing}):l.a.createElement(A,{key:a,idx:a,participant:n,onNameChange:t.props.onNameChange,onAvailabilityChange:t.props.onAvailabilityChange,onDeleteParticipant:t.props.onDeleteParticipant})})))}}]),e}(),O=function(t){function e(){return u(this,e),m(this,y(e).apply(this,arguments))}return b(e,l.a.Component),h(e,[{key:"render",value:function(){for(var t=this.props.polltimes,e=[],n=0;n<t.length;n++){var a=t[n],i=new Date(a.start),r=new Date(a.end);e.push(l.a.createElement("th",{key:n},l.a.createElement("span",{className:"poll-table-header-month"},E[i.getMonth()].slice(0,3)," "),l.a.createElement("br",null),l.a.createElement("span",{className:"poll-table-header-day"},i.getDate()," "),l.a.createElement("br",null),l.a.createElement("span",{className:"poll-table-header-weekday"},g[i.getDay()].slice(0,3)),l.a.createElement("br",null),l.a.createElement("span",{className:"poll-table-header-time"},T(i)),l.a.createElement("br",null),l.a.createElement("span",{className:"poll-table-header-time"},T(r)),l.a.createElement("br",null)))}return l.a.createElement("thead",{id:"poll-table-header"},l.a.createElement("tr",null,l.a.createElement("th",null),e))}}]),e}(),_=function(t){function e(){return u(this,e),m(this,y(e).apply(this,arguments))}return b(e,l.a.Component),h(e,[{key:"render",value:function(){for(var t=this.props.polltimes,e=this.props.participants,n=[],a=0;a<t.length;a++)n[a]=J(e.map(function(t){return"N"!=t.availability[a].availability}));return l.a.createElement("tr",{id:"poll-table-summary"},l.a.createElement("td",null,l.a.createElement("div",{id:"poll-participants-summary"},l.a.createElement("div",{id:"poll-n-participants"},e.length," participants"),this.props.isEditable?l.a.createElement("div",{id:"poll-add-participant",className:"fas fa-plus",onClick:this.props.onAddParticipant}):"")),t.map(function(t,e){return l.a.createElement("td",{key:e},l.a.createElement("div",{id:"poll-availability-summary",className:"fas fa-check"},n[e]))}))}}]),e}(),j=function(t){function e(t){var n;return u(this,e),(n=m(this,y(e).call(this,t))).handleStartEditing=n.handleStartEditing.bind(f(n)),n}return b(e,l.a.Component),h(e,[{key:"handleStartEditing",value:function(t){this.props.onStartEditing(this.props.idx)}},{key:"render",value:function(){var t=this.props.participant;return l.a.createElement("tr",{className:"poll-participant-row",editing:"false"},l.a.createElement("td",null,l.a.createElement("div",{className:"poll-participant-details"},l.a.createElement("div",{className:"poll-participant-icon fas fa-user-circle"}),l.a.createElement("div",{className:"poll-participant-name"},t.name),this.props.isEditable?l.a.createElement("div",{className:"poll-participant-edit fas fa-pen",onClick:this.handleStartEditing}):"")),t.availability.map(function(t,e){return l.a.createElement("td",{className:"poll-participant-availability",key:e,availability:t.availability},l.a.createElement("div",{className:M(t.availability)}))}))}}]),e}(),A=function(t){function e(t){var n;return u(this,e),(n=m(this,y(e).call(this,t))).handleNameChange=n.handleNameChange.bind(f(n)),n.handleAvailabilityChange=n.handleAvailabilityChange.bind(f(n)),n.handleDeleteParticipant=n.handleDeleteParticipant.bind(f(n)),n.nameInput=l.a.createRef(),n}return b(e,l.a.Component),h(e,[{key:"handleNameChange",value:function(t){var e=this.props.idx,n=t.target.value;this.props.onNameChange(e,n)}},{key:"handleAvailabilityChange",value:function(t,e){var n=this.props.idx,a=i()(e.target).attr("availability"),r="Y"==a?"M":"M"==a?"N":"Y";this.props.onAvailabilityChange(n,t,r)}},{key:"handleDeleteParticipant",value:function(t){this.props.onDeleteParticipant(this.props.idx)}},{key:"render",value:function(){var t=this,e=this.props.participant;return l.a.createElement("tr",{className:"poll-participant-row",editing:"true"},l.a.createElement("td",null,l.a.createElement("div",{className:"poll-participant-details"},l.a.createElement("div",{className:"poll-participant-delete fas fa-trash",onClick:this.handleDeleteParticipant}),l.a.createElement("input",{className:"poll-participant-name-input",ref:this.nameInput,type:"text",value:e.name,placeholder:"Enter your name",onChange:this.handleNameChange}))),e.availability.map(function(e,n){return l.a.createElement("td",{className:"poll-participant-availability",key:n},l.a.createElement("input",{type:"checkbox",className:"poll-participant-availability-checkbox "+M(e.availability),availability:e.availability,onChange:function(e){return t.handleAvailabilityChange(n,e)}}))}))}},{key:"componentDidMount",value:function(){this.nameInput.current.focus()}}]),e}(),D=function(t){function e(t){var n;return u(this,e),(n=m(this,y(e).call(this,t))).handleSubmit=n.handleSubmit.bind(f(n)),n}return b(e,l.a.Component),h(e,[{key:"isDisabled",value:function(){return""==this.props.participant.name}},{key:"handleSubmit",value:function(t){this.isDisabled()||this.props.onStopEditing()}},{key:"render",value:function(){var t=this.props.participant,e=this.props.isNewParticipant?"Send":"Update",n=0==J(t.availability.map(function(t){return"N"!=t.availability})),a=this.isDisabled()?"Enter your name first":n?"Cannot attend":null,i=null!=a;return l.a.createElement("div",{id:"poll-submit-button",isdisabled:this.isDisabled().toString(),cannotattend:n.toString(),hasnote:i.toString(),onClick:this.handleSubmit},l.a.createElement("div",{id:"poll-submit-action"},e),l.a.createElement("div",{id:"poll-submit-note"},a))}}]),e}();function T(t){var e,n=t.getHours();return n<12?e="am":(e="pm",n-=12),n+":"+t.getMinutes().toString().padStart(2,"0")+" "+e}function M(t){return"Y"==t?"fas fa-check":"M"==t?"fas fa-question":""}function J(t){return t.reduce(function(t,e){return t+e},0)}s.a.render(l.a.createElement("div",null,l.a.createElement(p.MainHeader,{entries:["dashboard","logout"],showCreatePollButton:!0}),",",l.a.createElement(P,{poll:S})),i()("#main")[0])},180:function(t,e,n){},9:function(t,e,n){"use strict";n.r(e);var a=n(2),i=n.n(a);var r=function(t){var e=null;if(document.cookie&&""!==document.cookie)for(var n=document.cookie.split(";"),a=0;a<n.length;a++){var i=n[a].trim();if(i.substring(0,t.length+1)===t+"="){e=decodeURIComponent(i.substring(t.length+1));break}}return e}("csrftoken");i.a.ajaxSetup({beforeSend:function(t,e){var n;n=e.type,/^(GET|HEAD|OPTIONS|TRACE)$/.test(n)||this.crossDomain||t.setRequestHeader("X-CSRFToken",r)}})}});
//# sourceMappingURL=poll.js.map